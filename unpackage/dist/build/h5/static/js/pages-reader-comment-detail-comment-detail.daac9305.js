(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-reader-comment-detail-comment-detail"],{"127e":function(e,t,i){"use strict";(function(e,i){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={data:function(){return{bookId:"",commentId:"",show:!1,requestInfo:!1,info:{},index:0,content:"",replys:[],praise:!1,openIssue:!1,focus:!1,form:{},responder:"",responderContent:"",controlOpenIssue:!0,type:0,collect:!1}},onShow:function(){},onLoad:function(e){this.commentId=e.commentId,this.bookId=e.bookId,this.praise="true"==e.praise,this.collect="true"==e.collect,this.getIdeaDetail(),this.getReply()},methods:{release:function(t){var n=this,o={};if(""!=this.content&&void 0!=this.content)if(0==t)o.type=t,o.bookId=this.bookId,o.commentId=this.commentId,o.content=this.content,o.userName=this.form.originator,o.accountId=this.form.originatorId,o.account=this.form.originator,o.headPortrait=this.form.headPortrait,uni.showLoading({}),e.callFunction({name:"reply",data:o}).then((function(e){n.form={},n.content="",uni.hideLoading(),n.hideIssue(),n.info.ideaReply++,n.getReply()}));else{o.type=t,o.bookId=this.bookId,o.commentId=this.commentId,this.form.content=this.content;var a=this.form;o.obj=a,e.callFunction({name:"reply",data:o}).then((function(e){n.form={},n.content="",a.time=e.result,i("log",a," at pages/reader/comment-detail/comment-detail.vue:197"),n.replys[n.index].children.unshift(a),n.hideIssue()}))}else this.toast("未输入任何评论信息")},hideIssue:function(e){this.openIssue=!1,this.focus=!1,this.form={},this.controlOpenIssue=!0},openInput:function(e,t,n){if(this.index=t,i("log",this.index," at pages/reader/comment-detail/comment-detail.vue:220"),this.controlOpenIssue){this.controlOpenIssue=!1,this.openIssue=!0,this.focus=!0;var o=uni.getStorageSync("userInfo");o?(this.form.originator=o.userName,this.form.originatorAccount=o.account,this.form.headPortrait=o.headPortrait,this.form.originatorId=o.accountId,0==e?(this.form.responder=this.info.comentBy,this.form.responderContent=this.info.comentContent,this.form.responderAccount=this.info.account,this.form.responderId=this.info.accountId,this.type=0):1==e?(void 0!=n?(this.form.responder=this.replys[this.index].children[n].originator,this.form.responderContent=this.replys[this.index].children[n].content,this.form.responderAccount=this.replys[this.index].children[n].originatorAccount,this.form.responderId=this.replys[this.index].children[n].originatorId):(this.form.responder=this.replys[this.index].userName,this.form.responderAccount=this.replys[this.index].account,this.form.responderContent=this.replys[this.index].content,this.form.responderId=this.replys[this.index].accountId),this.type=1):this.show?(i("log",this.index," at pages/reader/comment-detail/comment-detail.vue:281"),this.form.responder=this.replys[this.index].userName,this.form.responderAccount=this.replys[this.index].account,this.form.responderContent=this.replys[this.index].content,this.form.responderId=this.replys[this.index].accountId,this.type=1):(i("log",this.index," at pages/reader/comment-detail/comment-detail.vue:288"),this.form.responder=this.info.ideaBy,this.form.responderContent=this.info.ideaContent,this.form.responderAccount=this.info.account,this.form.responderId=this.info.accountId,this.form.ideaId=this.info.ideaId,this.type=0)):uni.showModal({title:"提示",content:"您还没有登录,是否登录",confirmText:"去登录",success:function(e){e.confirm?uni.redirectTo({url:"/pages/login/login"}):e.cancel&&i("log","用户点击取消"," at pages/reader/comment-detail/comment-detail.vue:244")}})}else this.controlOpenIssue=!0},collect1:function(t){var n=this,o=uni.getStorageSync("userInfo");if(o){this.collect=!this.collect;var a=this.collect?"add":"del";i("log",a," at pages/reader/comment-detail/comment-detail.vue:326"),e.callFunction({name:"comment_collect",data:{id:t,type:a,bookId:this.bookId,accountId:o.accountId?o.accountId:""}}).then((function(e){"add"==a&&n.toast("已收藏"),"del"==a&&n.toast("已取消收藏"),i("log",e," at pages/reader/comment-detail/comment-detail.vue:339")})).catch((function(e){n.collect=!n.collect}))}else uni.showModal({title:"提示",content:"您还没有登录,是否登录",confirmText:"去登录",success:function(e){e.confirm?uni.redirectTo({url:"/pages/login/login"}):e.cancel&&i("log","用户点击取消"," at pages/reader/comment-detail/comment-detail.vue:317")}})},thumbs:function(t){var n=uni.getStorageSync("userInfo");if(n){this.praise=!this.praise,this.praise?this.info.commentPraise=this.info.commentPraise+1:this.info.commentPraise=this.info.commentPraise-1;var o=this.praise?"add":"del";i("log",t," at pages/reader/comment-detail/comment-detail.vue:374"),e.callFunction({name:"comment_thumbs-up",data:{id:t,type:o,bookId:this.bookId,accountId:n.accountId?n.accountId:"",commentPraise:this.info.commentPraise}}).then((function(e){i("log",e," at pages/reader/comment-detail/comment-detail.vue:385")}))}else uni.showModal({title:"提示",content:"您还没有登录,是否登录",confirmText:"去登录",success:function(e){e.confirm?uni.redirectTo({url:"/pages/login/login"}):e.cancel&&i("log","用户点击取消"," at pages/reader/comment-detail/comment-detail.vue:359")}})},getReply:function(){var t=this,n=e.database();n.collection("reply").where({bookId:this.bookId,commentId:this.commentId}).orderBy("id","desc").get().then((function(e){i("log",e," at pages/reader/comment-detail/comment-detail.vue:395"),t.replys=e.result.data}))},lookReply:function(e){this.show=!0,this.index=e},getIdeaDetail:function(){var t=this;this.requestInfo=!1,i("log",this.id," at pages/reader/comment-detail/comment-detail.vue:408");var n=e.database(),o=n.collection("comment");o.where({bookId:this.bookId,commentId:this.commentId}).get().then((function(e){i("log",e," at pages/reader/comment-detail/comment-detail.vue:415"),t.info=e.result.data[0],t.requestInfo=!0})).catch((function(e){t.requestInfo=!0}))}}};t.default=n}).call(this,i("a9ff")["default"],i("0de9")["log"])},"167f":function(e,t,i){"use strict";i.r(t);var n=i("9f26"),o=i("d8e3");for(var a in o)"default"!==a&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("1702");var s,r=i("f0c5"),c=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,"cb6fa498",null,!1,n["a"],s);t["default"]=c.exports},1702:function(e,t,i){"use strict";var n=i("3a19"),o=i.n(n);o.a},3811:function(e,t,i){var n=i("24fb");t=n(!1),t.push([e.i,".ideaDetail .ideaBy[data-v-cb6fa498]{width:%?690?%;margin:0 auto;padding:%?20?% %?20?%;border-radius:%?15?%;background:#fff}.ideaDetail .ideaBy .userInfo[data-v-cb6fa498]{display:-webkit-box;display:-webkit-flex;display:flex}.ideaDetail .ideaBy .userInfo .left uni-image[data-v-cb6fa498]{width:%?80?%;height:%?80?%;border-radius:%?40?%}.ideaDetail .ideaBy .userInfo .right[data-v-cb6fa498]{margin-left:%?20?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-justify-content:space-around;justify-content:space-around}.ideaDetail .reply[data-v-cb6fa498]{width:%?690?%;margin:0 auto;margin-bottom:%?120?%;border-radius:%?20?%;padding-top:%?20?%;padding-bottom:%?20?%}.ideaDetail .reply .replyTitle[data-v-cb6fa498]{margin-top:%?20?%;font-size:%?32?%;margin-bottom:%?10?%;font-weight:500}.ideaDetail .reply .replyitem[data-v-cb6fa498]{background:#fff;padding:%?20?% 0}.ideaDetail .reply .replyitem .baseinfo[data-v-cb6fa498]{display:-webkit-box;display:-webkit-flex;display:flex}.ideaDetail .reply .replyitem .baseinfo .img uni-image[data-v-cb6fa498]{margin-left:%?20?%;margin-right:%?20?%;width:%?80?%;height:%?80?%;border-radius:%?40?%}.ideaDetail .reply .replyitem .baseinfo .right[data-v-cb6fa498]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.ideaDetail .reply .replyitem .baseinfo .right .name[data-v-cb6fa498]{-webkit-box-flex:1;-webkit-flex:1;flex:1}.ideaDetail .reply .replyitem .baseinfo .right .time[data-v-cb6fa498]{-webkit-box-flex:1;-webkit-flex:1;flex:1}.ideaDetail .reply .replyitem .content[data-v-cb6fa498]{margin-left:%?120?%;margin-right:%?30?%;word-wrap:break-word;padding-bottom:%?20?%;font-size:%?30?%;letter-spacing:%?2?%;line-height:%?36?%}.ideaDetail .reply .replyitem .child[data-v-cb6fa498]{margin-left:%?120?%;color:#0af;font-size:%?26?%}.ideaDetail .popup .title[data-v-cb6fa498]{padding:%?30?%;text-align:center;font-size:%?33?%}.ideaDetail .popup .popupitem[data-v-cb6fa498]{border-bottom:%?1?% solid #ccc;padding:%?20?% 0}.ideaDetail .popup .popupitem .baseinfo[data-v-cb6fa498]{display:-webkit-box;display:-webkit-flex;display:flex}.ideaDetail .popup .popupitem .baseinfo .img uni-image[data-v-cb6fa498]{margin-left:%?20?%;margin-right:%?20?%;width:%?80?%;height:%?80?%;border-radius:%?40?%}.ideaDetail .popup .popupitem .baseinfo .right[data-v-cb6fa498]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.ideaDetail .popup .popupitem .baseinfo .right .name[data-v-cb6fa498]{-webkit-box-flex:1;-webkit-flex:1;flex:1}.ideaDetail .popup .popupitem .baseinfo .right .time[data-v-cb6fa498]{-webkit-box-flex:1;-webkit-flex:1;flex:1}.ideaDetail .popup .popupitem .content[data-v-cb6fa498]{margin-left:%?120?%;margin-right:%?30?%;word-wrap:break-word;padding-bottom:%?20?%;font-size:%?30?%;letter-spacing:%?2?%;line-height:%?36?%}.ideaDetail .bom[data-v-cb6fa498]{position:fixed;bottom:0;background-color:#fff;width:100%;z-index:9;height:%?110?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}.ideaDetail .bom .bom-input[data-v-cb6fa498]{width:%?500?%;height:%?70?%;background-color:#eaeaea;border-radius:%?30?%;font-size:%?28?%;padding-left:%?30?%}.ideaDetail .bom .thumb[data-v-cb6fa498]{margin-left:%?20?%}.ideaDetail .bom .collect[data-v-cb6fa498]{margin-left:%?20?%}.issue[data-v-cb6fa498]{position:fixed;bottom:0;background-color:#fff;width:100%;z-index:9;padding:%?25?% %?30?%}.issue .responerInfo[data-v-cb6fa498]{padding-bottom:%?20?%;font-size:%?26?%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.issue .issue-main[data-v-cb6fa498]{display:-webkit-box;display:-webkit-flex;display:flex}.issue .issue-main .content[data-v-cb6fa498]{width:%?550?%;height:%?90?%;border-radius:%?30?%;background-color:#f8f8f8;padding:%?30?%;font-size:%?28?%}.issue .issue-main .btn[data-v-cb6fa498]{width:%?140?%;text-align:center;margin-left:%?20?%;-webkit-align-self:flex-end;align-self:flex-end}.issue .issue-main .btn uni-view[data-v-cb6fa498]{width:%?120?%;background:#faf;color:#fff;font-weight:500;font-size:%?32?%;padding:%?5?% %?20?%;border-radius:%?20?%}",""]),e.exports=t},"3a19":function(e,t,i){var n=i("3811");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var o=i("4f06").default;o("17824847",n,!0,{sourceMap:!1,shadowMode:!1})},"9f26":function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return n}));var n={uIcon:i("1203").default,uPopup:i("69d9").default},o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"ideaDetail"},[e.requestInfo?i("v-uni-view",{staticClass:"ideaBy"},[i("v-uni-view",{staticClass:"userInfo"},[i("v-uni-view",{staticClass:"left"},[i("v-uni-image",{attrs:{src:e.info.headPortrait,mode:""}})],1),i("v-uni-view",{staticClass:"right"},[i("v-uni-view",[e._v(e._s(e.info.comentBy))]),i("v-uni-view",[e._v(e._s(e.info.commentTime))])],1)],1),i("v-uni-view",{staticClass:"body"},[i("v-uni-view",{},[e._v(e._s(e.info.comentTitle))]),i("v-uni-view",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.openInput(0)}}},[e._v(e._s(e.info.commentContent))])],1),i("v-uni-view",{staticStyle:{"text-align":"right"}},[i("v-uni-view",{staticStyle:{"margin-right":"50rpx",display:"inline-block"}},[i("u-icon",{staticStyle:{"margin-right":"8rpx"},attrs:{size:"34rpx",name:"chat"}}),e._v(e._s(e.info.commentReply))],1),i("v-uni-view",{staticStyle:{display:"inline-block"}},[i("u-icon",{staticStyle:{"margin-right":"8rpx"},attrs:{color:1==e.praise?"red":"inherit",name:"thumb-up",size:"34rpx"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.thumbs(e.info._id)}}}),e._v(e._s(e.info.commentPraise))],1)],1)],1):e._e(),0!=e.replys?i("v-uni-view",{staticClass:"reply"},[i("v-uni-view",{staticClass:"replyTitle"},[e._v("全部回复")]),e._l(e.replys,(function(t,n){return i("v-uni-view",{key:t._id,staticClass:"replyitem"},[i("v-uni-view",{staticClass:"baseinfo"},[i("v-uni-view",{staticClass:"img"},[i("v-uni-image",{attrs:{src:t.headPortrait,mode:""}})],1),i("v-uni-view",{staticClass:"rigth"},[i("v-uni-view",{staticClass:"createBy"},[e._v(e._s(t.userName))]),i("v-uni-view",{staticClass:"time"},[e._v(e._s(t.time))])],1)],1),i("v-uni-view",{staticClass:"content",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.openInput(1,n)}}},[e._v(e._s(t.content))]),t.children&&0!=t.children.length?i("v-uni-view",{staticClass:"child",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.lookReply(n)}}},[e._v("查看"+e._s(t.children.length)+"条回复>>")]):e._e()],1)}))],2):e._e(),i("u-popup",{staticClass:"popup",attrs:{"z-index":"8",closeable:!0,length:"80%",mode:"bottom","border-radius":"14"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[i("v-uni-view",{staticClass:"title"},[e._v("回复信息")]),i("v-uni-scroll-view",{staticStyle:{height:"75%"},attrs:{"scroll-y":"true"}},[e.show?i("v-uni-view",{staticStyle:{"margin-bottom":"110rpx"}},e._l(e.replys[e.index].children,(function(t,n){return i("v-uni-view",{staticClass:"popupitem"},[i("v-uni-view",{staticClass:"baseinfo"},[i("v-uni-view",{staticClass:"img"},[i("v-uni-image",{attrs:{src:t.headPortrait,mode:""}})],1),i("v-uni-view",{staticClass:"rigth"},[i("v-uni-view",{staticClass:"createBy"},[e._v(e._s(t.originator))]),i("v-uni-view",{staticClass:"time"},[e._v(e._s(t.time))])],1)],1),i("v-uni-view",{staticClass:"content",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.openInput(1,e.index,n)}}},[t.originatorId!=t.responderId?i("v-uni-text",[e._v("回复")]):e._e(),t.originatorId!=t.responderId?i("v-uni-text",{staticStyle:{color:"#007AFF","margin-left":"8rpx"}},[e._v(e._s(t.responder)+":")]):e._e(),e._v(e._s(t.content))],1)],1)})),1):e._e()],1)],1),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:0==e.openIssue,expression:"openIssue==false"}],staticClass:"bom"},[i("v-uni-input",{staticClass:"bom-input",attrs:{disabled:!0,border:!0,placeholder:"点击发表评论"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.openInput(-1,e.index)}}}),i("v-uni-view",{},[i("u-icon",{staticClass:"thumb",staticStyle:{"margin-right":"8rpx"},attrs:{color:1==e.praise?"red":"inherit",name:"thumb-up",size:"44rpx"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.thumbs(e.info._id)}}}),i("u-icon",{staticClass:"collect",staticStyle:{"margin-right":"8rpx"},attrs:{color:"#ffaa00",name:1==e.collect?"heart-fill":"heart",size:"44rpx"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.collect1(e.info._id)}}})],1)],1),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:e.openIssue,expression:"openIssue"}],staticClass:"issue",on:{touchend:function(t){t.preventDefault(),arguments[0]=t=e.$handleEvent(t)}}},[i("v-uni-view",{staticClass:"responerInfo"},[e._v("回复"+e._s(e.form.responder)+"："+e._s(e.form.responderContent))]),i("v-uni-view",{staticClass:"issue-main"},[i("v-uni-textarea",{staticClass:"content",attrs:{"cursor-spacing":"100",focus:e.focus,placeholder:"我来评论",type:"textarea"},on:{blur:function(t){arguments[0]=t=e.$handleEvent(t),e.hideIssue.apply(void 0,arguments)}},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),i("v-uni-view",{staticClass:"btn"},[i("v-uni-view",{on:{touchend:function(t){t.preventDefault(),arguments[0]=t=e.$handleEvent(t),e.release(e.type)}}},[e._v("发表")])],1)],1)],1)],1)},a=[]},d8e3:function(e,t,i){"use strict";i.r(t);var n=i("127e"),o=i.n(n);for(var a in n)"default"!==a&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t["default"]=o.a}}]);