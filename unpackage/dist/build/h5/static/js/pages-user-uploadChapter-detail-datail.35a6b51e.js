(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-user-uploadChapter-detail-datail"],{5394:function(t,e,a){var o=a("ea77");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var n=a("4f06").default;n("bf129918",o,!0,{sourceMap:!1,shadowMode:!1})},"733d":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return o}));var o={uForm:a("6cc9").default,uFormItem:a("4672").default,uInput:a("a461").default,uButton:a("3451").default},n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return 1==t.loading?a("v-uni-view",{staticClass:"chapter"},[a("u-form",{ref:"uForm",staticClass:"form",attrs:{model:t.form}},[a("u-form-item",{attrs:{"label-width":"140",label:"章节名:"}},[a("u-input",{attrs:{placeholder:"请输入章节名"},model:{value:t.form.chapterName,callback:function(e){t.$set(t.form,"chapterName",e)},expression:"form.chapterName"}})],1),a("u-form-item",{attrs:{"label-width":"140",label:"章节内容:"}}),a("v-uni-editor",{staticClass:"container",attrs:{id:"editor",border:!0,placeholder:"请输入章节内容"},on:{ready:function(e){arguments[0]=e=t.$handleEvent(e),t.onEditorReady.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"btn"},[a("u-button",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.save()}}},[t._v("保存章节")]),a("u-button",{attrs:{type:"success"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.upload()}}},[t._v("上传章节")])],1)],1)],1):t._e()},r=[]},"75ce":function(t,e,a){"use strict";(function(t){var o=a("4ea4");a("ac1f"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("96cf");var n=o(a("1da1")),r={data:function(){return{form:{},bookid:"",editorCtx:"",bookName:"",text:"",loading:!1}},onLoad:function(e){var a=this;this.bookid=e.id,this.bookName=e.bookName;var o=uni.getStorageSync("userInfo"),n=t.database();n.collection("saveChapter").where({bookid:this.bookid,accountId:o.accountId}).get().then((function(t){a.loading=!0,0!=t.result.data.length&&(a.$set(a.form,"chapterName",t.result.data[0].chapterName),a.text=t.result.data[0].chapterContent,console.log(t))}))},methods:{onEditorReady:function(){var t=this;uni.createSelectorQuery().select("#editor").context((function(e){t.editorCtx=e.context,t.editorCtx.format("textIndent","2em"),t.editorCtx.setContents({html:t.text})})).exec()},save:function(){var e=this;return(0,n.default)(regeneratorRuntime.mark((function a(){var o,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return o="",n=e,r=uni.getStorageSync("userInfo"),a.next=5,e.editorCtx.getContents({success:function(e){o="<p><br></p>"==e.html?"":e.html,console.log(o),t.callFunction({name:"saveChapter",data:{accountId:r.accountId,bookName:n.bookName,bookid:n.bookid,chapterContent:o,chapterName:n.form.chapterName}}).then((function(t){n.toast("保存成功")}))}});case 5:case"end":return a.stop()}}),a)})))()},upload:function(){var e="",a=this,o=uni.getStorageSync("userInfo");this.editorCtx.getContents({success:function(n){e="<p><br></p>"==n.html?"":n.html,void 0!=a.form.chapterName&&""!=a.form.chapterName?""!=e?t.callFunction({name:"uploadChapter",data:{accountId:o.accountId,bookName:a.bookName,bookid:a.bookid,chapterContent:e,chapterName:a.form.chapterName}}).then((function(t){console.log(t),a.toast("上传成功"),uni.navigateTo({url:"/pages/user/uploadChapter/uploadChapter"})})):a.toast("未填写章节内容"):a.toast("未填写章节名")}})}}};e.default=r}).call(this,a("a9ff")["default"])},"7d2d":function(t,e,a){"use strict";var o=a("5394"),n=a.n(o);n.a},"8b66":function(t,e,a){"use strict";a.r(e);var o=a("733d"),n=a("eab2");for(var r in n)"default"!==r&&function(t){a.d(e,t,(function(){return n[t]}))}(r);a("7d2d");var c,i=a("f0c5"),u=Object(i["a"])(n["default"],o["b"],o["c"],!1,null,"e69e7170",null,!1,o["a"],c);e["default"]=u.exports},ea77:function(t,e,a){var o=a("24fb");e=o(!1),e.push([t.i,".chapter .form[data-v-e69e7170]{padding:0 %?30?%}.chapter .btn[data-v-e69e7170]{display:-webkit-box;display:-webkit-flex;display:flex;margin-top:%?100?%}.chapter .container[data-v-e69e7170]{border:%?1?% solid silver;padding:%?15?%}",""]),t.exports=e},eab2:function(t,e,a){"use strict";a.r(e);var o=a("75ce"),n=a.n(o);for(var r in o)"default"!==r&&function(t){a.d(e,t,(function(){return o[t]}))}(r);e["default"]=n.a}}]);